

# This file was *autogenerated* from the file baby-alice.sage
from sage.all_cmdline import *   # import sage library

_sage_const_1 = Integer(1); _sage_const_32 = Integer(32); _sage_const_2 = Integer(2); _sage_const_512 = Integer(512); _sage_const_0p5 = RealNumber('0.5'); _sage_const_0 = Integer(0)
from sage.all import *

n = 499795193308049138808570945696387289874119832358539620801430788624782549473065836244596521327260368551860734946264862223993848622137242403724897999727957974381953991246274020854749306201585920190525301219304844806344783927921109781726334716579305235202895091072706984260292033155913116347015540703764332924709647126284723563473196146966846953474788278646476722426699618618983718886910005568128748282914719433661956571306774933264995033855501238854403085187803762447811410160711881520044517442018486799330170276184983263168663502764139510102688780673676571524798623971025295303441298278526309905444400709391050022704869 
e = 656506809 

n2 = 302785337204341301926996418735736099660010712297423196204444558248502753636733385325366614992052038675160435684040841415703395145143642123799189152476274532598030361221866162127832780235252797017162079082115726957408904472033759868594288572978545542452317728952043503674725315719961060469450020754090299017326306586827990099907471443585259322794463697997205654438793016421603371821120084564436188242597449758420801890375553379371572683652033573979862339813065869205775461521277215399225253154824807543277758323066128997161080255197242055659039736364268751053053843637190716932383192357165383989513658479377378617016811 
e2 = 885335741 

print('RSA_secrets')
n0 = 10923560081932760392759419101271976251916205965042714361360927360998396102650896680458021597948077776901744236351925897306268319176052984267625827547860646479337035430265490413300660411908018358438620754226599553682916751432020679381880517168163374862633120600299564734518692915387374624935442478872173461030794862762863598537733277517056266949451033814926385767314158454995693320428923283318661247695263181314233544151446297444924494545786597767009802074241551076655700397410638266516094637891166074621589947164411781708889354552994079269499869188636627652111123417986906488158729106216963116527386222738691034606681 
e0 = 100 

for i in range(_sage_const_1 , _sage_const_32 ):
	div = int(n0//i)
	papprox = isqrt(div)
	qapprox = i*papprox + _sage_const_2 **_sage_const_512 
	F = PolynomialRing(Zmod(n0), names=('x',)); (x,) = F._first_ngens(1)
	f = x - qapprox
	d = f.small_roots(X=_sage_const_2 **_sage_const_512 , beta=_sage_const_0p5 )
	if d:
		d = d[_sage_const_0 ]
		print("rsa_secrets p0: ",qapprox - d)
		break
		
for i in range(_sage_const_1 , _sage_const_32 ):
	div = int(n//i)
	papprox = isqrt(div)
	qapprox = i*papprox + _sage_const_2 **_sage_const_512 
	F = PolynomialRing(Zmod(n), names=('x',)); (x,) = F._first_ngens(1)
	f = x - qapprox
	d = f.small_roots(X=_sage_const_2 **_sage_const_512 , beta=_sage_const_0p5 )
	if d:
		d = d[_sage_const_0 ]
		print("p1: ",qapprox - d)
		break
		
for i in range(_sage_const_1 , _sage_const_32 ):
	div = int(n2//i)
	papprox = isqrt(div)
	qapprox = i*papprox + _sage_const_2 **_sage_const_512 
	F = PolynomialRing(Zmod(n2), names=('x',)); (x,) = F._first_ngens(1)
	f = x - qapprox
	d = f.small_roots(X=_sage_const_2 **_sage_const_512 , beta=_sage_const_0p5 )
	if d:
		d = d[_sage_const_0 ]
		print("p2: ",qapprox - d)
		break

